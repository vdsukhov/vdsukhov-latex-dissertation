\pdfbookmark{Общая характеристика работы}{characteristic}             % Закладка pdf
\section*{Общая характеристика работы}

\newcommand{\actuality}{\pdfbookmark[1]{Актуальность}{actuality}\textbf{\actualityTXT}}
\newcommand{\progress}{\pdfbookmark[1]{Степень разработанности темы исследования}{progress}\textbf{\progressTXT}}
\newcommand{\aim}{\pdfbookmark[1]{Цели}{aim}{\textbf\aimTXT}}
\newcommand{\tasks}{\pdfbookmark[1]{Задачи}{tasks}\textbf{\tasksTXT}}
\newcommand{\aimtasks}{\pdfbookmark[1]{Цели и задачи}{aimtasks}\aimtasksTXT}
\newcommand{\novelty}{\pdfbookmark[1]{Научная новизна}{novelty}\textbf{\noveltyTXT}}
\newcommand{\passport}{\pdfbookmark[1]{Соответствие паспорту специальности.}{passport}\textbf{\passportTXT}}
\newcommand{\theorinfluence}{\pdfbookmark[1]{Теоретическая значимость}{theorinfluence}\textbf{\theorinfluenceTXT}}
\newcommand{\influence}{\pdfbookmark[1]{Практическая значимость}{influence}\textbf{\influenceTXT}}
\newcommand{\methods}{\pdfbookmark[1]{Методология и методы исследования}{methods}\textbf{\methodsTXT}}
\newcommand{\defpositions}{\pdfbookmark[1]{Положения, выносимые на защиту}{defpositions}\textbf{\defpositionsTXT}}
\newcommand{\integration}{\pdfbookmark[1]{Внедрение}{integration}\textbf{\integrationTXT}}
\newcommand{\reliability}{\pdfbookmark[1]{Достоверность}{reliability}\textbf{\reliabilityTXT}}
\newcommand{\probation}{\pdfbookmark[1]{Апробация}{probation}\textbf{\probationTXT}}
\newcommand{\contribution}{\pdfbookmark[1]{Личный вклад}{contribution}\textbf{\contributionTXT}}
\newcommand{\publications}{\pdfbookmark[1]{Публикации}{publications}\textbf{\publicationsTXT}}

\input{common/characteristic} % Характеристика работы по структуре во введении и в автореферате не отличается (ГОСТ Р 7.0.11, пункты 5.3.1 и 9.2.1), потому её загружаем из одного и того же внешнего файла, предварительно задав форму выделения некоторым параметрам

%Диссертационная работа была выполнена при поддержке грантов \dots

%\underline{\textbf{Объем и структура работы.}} Диссертация состоит из~введения,
%четырех глав, заключения и~приложения. Полный объем диссертации
%\textbf{ХХХ}~страниц текста с~\textbf{ХХ}~рисунками и~5~таблицами. Список
%литературы содержит \textbf{ХХX}~наименование.

\pdfbookmark{Содержание работы}{description}                          % Закладка pdf
\section*{Содержание работы}
Во \textbf{введении} приводится аргументация и обоснование актуальности проведенного исследования, произведен анализ и обозрение научных источников по исследуемой проблеме, формулируется цель, производится формальная постановка задач, определены научная новизна и практическая значимость представляемой работы.

% обосновывается актуальность исследований, проводимых в рамках данной диссертационной работы, приводится обзор научной литературы по изучаемой проблеме, формулируется цель, ставятся задачи работы, сформулированы научная новизна и практическая значимость представляемой работы.

\textbf{Первая глава} посвящена обзору предметной области системной биологии и детальному рассмотрению вопросов, связанных с задачами обнаружения совместной регуляции экспрессии генов в транскриптомных данных. 
В главе приводятся определение и объяснение необходимого минимума биологических терминов и концепций. Рассмотрены классические методы, которые применяются для решения схожих задач, а также рассматриваются их ограничения и несовершенства. 
В завершении главы приводятся сформулированная цель исследования и производится формальная постановка задач, рассматриваемых в диссертационной работе.

Фундаментальным положением системной биологии является центральная догма молекулярной биологии, которая характеризует наблюдаемые правила реализации генетической информации живых существ.
При этом ключевыми элементами догмы являются: дезоксирибонуклеиновая кислота (ДНК), рибонуклеиновая кислота (РНК) и белок.
Основополагающим правилом передачи информации является процесс переходов {ДНК $\rightarrow$ РНК $\rightarrow$ белок}.
В этих переходах ДНК играет роль матрицы, которая кодирует информацию о различных белках, которые в свою очередь выполняют определенные функции в клетках организмов.
Последовательность нуклеотидов в цепи ДНК, кодирующая конкретный белок, называется геном.
Процесс перехода от ДНК к белку принято называть экспрессией генов.

В настоящее время существует несколько технологий \fixme{\cite{}}, которые позволяют определить количество РНК-транскриптов в клетках, исследуемых биологических образцов.
Совокупность результатов, полученных вышеуказанными технологиями, принято называть транскриптомными данными.
При этом исследователям известен факт наличия зависимости между количеством белков и РНК-транскриптов.
Тем самым, это позволяет делать выводы о функциональных особенностях, протекающих в организме, имея в расположении информацию о количестве РНК-транскриптов.


Для исследования и обнаружения новых функциональных особенностей с использованием транскриптомных данных часто применяется следующая стратегия \fixme{\cite{}}.
Выделяются две группы организмов, которые соответствуют различным биологическим состоянием.
Например, группа организмов имеющая определенное биологическое заболевание, а другая без него.
Результаты, полученных транскриптомных данных, чаще всего представляют в виде числовой матрицы, где каждая строка матрицы соответствует определенному гену, а столбцы соответствуют биологическим образцам.
При этом каждое значение матрицы характеризуют величину экспрессии гена в определенном образце.

Следующим классическим этапом анализа полученных данных является применение методов по анализу дифференциальной экспрессии генов \fixme{\cite{}}. 
Концептуально, методы направлены на сопоставление каждой строчке матрицы экспрессии генов числа, которое характеризует степень изменения регуляции гена при сравнении двух биологических состояний.
Эти методы позволяют сравнивать регуляцию генов между собой, а также возвращают P-значения, которые говорят о статистической значимости регуляции конкретного гена.
Как результат, по полученным данным можно говорить о статистически значимо регулируемых генов по отдельности, однако известно что существуют биологические процессы, которые включают в себя взаимодействия сразу между множеством генов.
Для хорошо известных процессов существуют специально составленные базы данных \fixme{\cite{}} в которых наборам генов сопоставляются их функции.

Как следствие, встаёт вопрос определения статистической значимости регуляции не для генов по отдельности, а для наборов генов.
Одним из стандартных методов, решающих эту задачу является Gene Set Enrichment Analysis (GSEA) \fixme{\cite{}}.
Метод принимает на вход ранжированный список генов и коллекцию наборов генов, где для каждого набора необходимо определить его статистическую значимость. 
Обычно в качестве ранжирования используются результаты анализа дифференциальной экспрессии генов.
Основой метода GSEA являются статистика представленности для набора генов и применение методов Монте-Карло для генерирования случайных наборов генов.
Полученные случайные наборы генов используются для определения статистической значимости наборов из переданной на вход коллекции.

Однако, вышеуказанный метод имеет несколько ограничений.
Во-первых, это скорость работы, которая существенно усложняет процесс проведения быстрого анализа представленности наборов генов.
Во-вторых, так как метод основан на применении простого семплирования это приводит к невозможности вычисления экстремально малых P-значений.
Последний факт играет важную роль, так как это ограничение способно оказывать влияние на выводы относительно статистической значимости исследуемых наборов генов.

В выпускной квалификационной работе \fixme{\cite{}} был предложен приближенный алгоритм, основанный на применении многоуровневого подхода Монте-Карло.
Этот подход позволяет вычислять произвольно малые P-значения за разумное время работы.
Тем не менее, алгоритм был представлен в виде прототипа без комплексного анализа сходимости его решений.
Данный факт требовал дополнительного изучения вопросов его сходимости и верификации получаемых результатов.

В настоящей работе будет исследован вопрос сходимости, получаемых P-значений к истинным и определены параметры метода, которые позволяют утверждать о сходимости метода при приложениях его на практике.
Также, будет показан корректный переход к логарифмам P-значений, который учитывает теоретические свойства распределений случайных величин и будет получено аналитическое выражение для накапливаемой ошибки алгоритма.

Все вышесказанное относится к анализу представленности и исследованию совместной регуляции генов для случая, когда в биологическом эксперименте участвуют строго две группы образцов.
Однако, удешевление стоимости проведения эксперимента по получению транскриптомных данных привело к появлению экспериментов со сложным дизайном.
Под сложным дизайном подразумевается эксперимент, в котором присутствует  большое число (> 2) различных групп образцов.
Это делает невозможным прямое применение вышеописанных методов на практике и требует развития концептуально новых методов для их анализа.



% картинку можно добавить так:
% \begin{figure}[ht]
%     \centerfloat{
%         \hfill
%         \subcaptionbox{\LaTeX}{%
%             \includegraphics[scale=0.27]{latex}}
%         \hfill
%         \subcaptionbox{Knuth}{%
%             \includegraphics[width=0.25\linewidth]{knuth1}}
%         \hfill
%     }
%     \caption{Подпись к картинке.}\label{fig:latex}
% \end{figure}

% Формулы в строку без номера добавляются так:
% \[
%     \lambda_{T_s} = K_x\frac{d{x}}{d{T_s}}, \qquad
%     \lambda_{q_s} = K_x\frac{d{x}}{d{q_s}},
% \]

\textbf{Вторая глава} посвящена исследованию сходимости метода FGSEA-Multilevel, анализу теоретических свойств наблюдаемых распределений для оценок P-значений.
Проведено сравнение метода FGSEA-Multilevel с точным методом, который работает для случая целочисленного вида статистик генов.

Входными данными для метода FGSEA-Multilevel являются вектор $S = \left(S_1, S_2, \ldots, S_N\right)$ размера $N$ и коллекция функциональных наборов генов $P$.
Для определения статистической значимости для исследуюемого набора генов $p$ вводится следующая статистика представленности:
\[
    s(p) = \max_i \vert ES_i \vert,
\]
где значение $ES_i$ определяется как
\[
    ES_i = 
    \begin{cases}
        0, & \text{если } i = 0, \\
        ES_{i - 1} + \frac{\vert S_i \vert}{\sum\limits_{i \in p} \vert S_i \vert}, & \text{если } 1 \leqslant i \leqslant N \ \text{и } i \in p, \\
        ES_{i - 1} - \frac{1}{N - k}, & \text{если } 1 \leqslant i \leqslant N \ \text{и } i \not\in p.
    \end{cases}    
\]
Введенная статистика представленности позволяет говорить о статистической значимости регуляции того или иного набора генов из коллекции.

Для определения статистической значимости необходимо вычислить вероятность вида:
\[
    \mathrm{P} \left(s(X) \geqslant s(p) \right),
\]
где $X$ случайный набор генов такого же размера что и набор генов $p$. 

На практике значение вероятностей может быть экстремально мало ($\ll 1$). 
Вычисление таких вероятностей выполняется при помощи алгоритма, основанного на многоуровневой схеме Монте-Карло.
Суть алгоритма заключается в введении расщепления $-1 = l_0 < l_1 < \ldots < l_t = s(p)$ для значений статистики представленности.
После этого, искомая вероятность может быть оценена следующим выражением $\mathrm{P} \left(s(X) \geqslant s(p) \right) \approx \prod\limits_{i = 1}^{t} \alpha_i$, где $\alpha_i = \mathrm{P} \left(s(X) \geqslant l_i \mid s(X) \geqslant l_{i - 1} \right)$.
В качестве $l_i$ рассматриваются медианы выборок, полученных на каждом шаге, поэтому $\alpha_i \approx 0.5$.
Генерирование равномерной выборки на каждом шаге осуществляется при помощи использования алгоритма Метрополиса. 

Краткое описание алгоритма Метрополиса для генерирования равномерной выборки из распределения $\mathrm{P}\left(\cdot \mid s(X) \geqslant l_i \right)$ выглядит следующим образом:
\begin{enumerate}
    \item Устанавливаем счётчик шагов равным нулю.
    \item Начинаем с выборки $X_1, X_2, \ldots X_W$ такой, что $s(X_j) \geqslant l_i$
    \item Последовательно рассматриваем набор генов $X_j$, случайным образом выбираем ген из набора и заменяем его случайным образом генов не из набора. В случае, если замена сохранила условие $s(X_j) \geqslant l_i, \ j \in \{1, 2, \ldots, W \}$, тогда увеличиваем счетчик шагов на единицу, в противном случае отменяем изменения без инкрементирования счетчика шагов.
\end{enumerate}
От числа шагов напрямую зависит корректность вычисляемой оценки для вероятности $\mathrm{P}\left(\cdot \mid s(X) \geqslant l_i \right)$. 
Для определения необходимого числа шагов было произведено исследование, получаемых оценок для вероятностей, путем рассмотрения большого числа примеров транскриптомных данных и различных коллекций функциональных наборов генов.  
В качестве референса для метода FGSEA-Multilevel использовался точный метод \fixme{\cite{}}, который работает для случая целочисленного вектора статистик для генов и основан на применении динамического программирования.
Для определения необходимого числа шагов рассматривалась величина вида $\text{steps} = a \cdot k \cdot W$, здесь $W$ - размер выборки, $k$ - размер набора генов, $a$ параметр, который варьировался.
Было продемонстрировано, что на практике достаточно положить $a = 1$. В качестве критерия сходимости метода использовался подход в котором получаемые оцени для P-значений должны попасть в интервал $\left(P_{true} - 2 \cdot \mathrm{SEM}, P_{true} + 2 \cdot \mathrm{SEM} \right)$, где $P_{true}$ истинное значение и $\mathrm{SEM}$ - стандартная ошибка среднего.

На практике при вычислении вероятностей бывает удобно перейти к вычислению логарифма вероятности.
Однако, прямое применение функции логарифма к левой и правой частям выражения $\mathrm{P} \left(s(X) \geqslant s(p) \right) \approx \prod\limits_{i = 1}^{t} \alpha_i $ приводит к тому, что правая часть выражения перестает быть несмещенной оценкой для левой части.
Для корректного перехода необходимо учесть свойство распределения медианы $m$ выборки размера $W$ из равномерного распределения, которое утверждает что в таком случае $m$ соответствует бета-распределению с параметрами $\mathrm{B} \left((W + 1) / 2, (W + 1)/ 2 \right)$. Тогда, несмещенная оценка для логарифма P-значения:
\[
    \log \mathrm{P} \left(s(X) \geqslant s(p) \right) \approx (t - 1) \cdot \left( \psi \left( \frac{Z + 1}{2}\right) - \psi \left(Z + 1 \right)\right) + \log (\alpha_t),
\]
где $\psi$ - дигамма-функция.

\fixme{Про введенную ошибку которая что-то делает :)}


В \textbf{третьей главе} определена оригинальная статистика представленности, которая применяется для экспериментов со сложным дизайном.
Она послужила основой для метода GESECA, который направлен на проведение анализа представленности и обнаружение совместно регулируемых генов в транскриптомных данных со сложным дизайном.

Для случая транскриптомных данных в которых присутствует более чем два различных биологических состояния, становится невозможным прямое применение классического подхода основанного на анализе дифференциальной экспрессии генов. В качестве решения данной проблемы предлагается использовать следующую величину в качестве статистики представленности для набора генов:
\[
       sg(X) = \mathrm{D} \left(\frac{E^T \cdot \overrightarrow{X}}{\Vert \overrightarrow{X} \Vert}\right),
\]
где $\mathrm{D}$ обозначает диссперсию, $E$ матрица транскриптомных данных (строчки соответствуют генам, столбцы соответствуют образцам) и $\overrightarrow{X}$ - вектор следующего вида
\[
    \overrightarrow{X} = \begin{cases}
        1, & \text{если } i \in X \\,
        0, & \text{если } i \not\in X.
    \end{cases}
\]

После введения статистики представленности $sg(\cdot)$ можно аналогичным образом как это было осуществлено в главе 2 задаться вопросом определения статистической значимсоти для набора генов $p$.
Для этого необходимо вычислить следующее P-значение:
\[
    \mathrm{P} \left( sg(X) \geqslant sg(p) \right). 
\] 

На практике, так же как это было и для P-значений из главы 2, не имеется аналитического выражения, которое бы сразу позволило вычислить эту вероятность.
Поэтому вводится оценка для искомой вероятности, которая вычисляется при помощи генерации выборок случайных наборов генов.

Для решения проблемы вычисления вероятностей редких событий, которые имеют экстремально малые P-значения, применяется многоуровневый подход Монте-Карло.

В действительности, этот метод может быть без ограничений применен для случая эксперимента с простым дизайном.
Для таких случаев результаты работы метода GESECA находятся в хорошем соответствии с классическими методами, базирующимися на использовании результатов дифференциальной экспрессии генов.

В результате был разработан новый метод GESECA, позволяющий проводить анализ представленности и находить совместно регулируемые гены в транскриптомных данных со сложным и простым дизайном экспериментов.


Можно сослаться на свои работы в автореферате. Для этого в файле
\verb!Synopsis/setup.tex! необходимо присвоить положительное значение
счётчику \verb!\setcounter{usefootcite}{1}!. В таком случае ссылки на
работы других авторов будут подстрочными.
Изложенные в третьей главе результаты опубликованы в~\cite{vakbib1, vakbib2}.
Использование подстрочных ссылок внутри таблиц может вызывать проблемы.


В \underline{\textbf{четвертой главе}} приведено описание

\FloatBarrier
\pdfbookmark{Заключение}{conclusion}                                  % Закладка pdf
В \underline{\textbf{заключении}} приведены основные результаты работы, которые заключаются в следующем:
\input{common/concl}

\pdfbookmark{Литература}{bibliography}                                % Закладка pdf
При использовании пакета \verb!biblatex! список публикаций автора по теме
диссертации формируется в разделе <<\publications>>\ файла
\verb!common/characteristic.tex!  при помощи команды \verb!\nocite!

\ifdefmacro{\microtypesetup}{\microtypesetup{protrusion=false}}{} % не рекомендуется применять пакет микротипографики к автоматически генерируемому списку литературы
\urlstyle{rm}                               % ссылки URL обычным шрифтом
\ifnumequal{\value{bibliosel}}{0}{% Встроенная реализация с загрузкой файла через движок bibtex8
    \renewcommand{\bibname}{\large \bibtitleauthor}
    \nocite{*}
    \insertbiblioauthor           % Подключаем Bib-базы
    %\insertbiblioexternal   % !!! bibtex не умеет работать с несколькими библиографиями !!!
}{% Реализация пакетом biblatex через движок biber
    % Цитирования.
    %  * Порядок перечисления определяет порядок в библиографии (только внутри подраздела, если `\insertbiblioauthorgrouped`).
    %  * Если не соблюдать порядок "как для \printbibliography", нумерация в `\insertbiblioauthor` будет кривой.
    %  * Если цитировать каждый источник отдельной командой --- найти некоторые ошибки будет проще.
    %
    %% authorvak
    \nocite{vakbib1}%
    \nocite{vakbib2}%
    %
    %% authorwos
    \nocite{wosbib1}%
    %
    %% authorscopus
    \nocite{scbib1}%
    %
    %% authorpathent
    \nocite{patbib1}%
    %
    %% authorprogram
    \nocite{progbib1}%
    %
    %% authorconf
    \nocite{confbib1}%
    \nocite{confbib2}%
    %
    %% authorother
    \nocite{bib1}%
    \nocite{bib2}%

    \ifnumgreater{\value{usefootcite}}{0}{
        \begin{refcontext}[labelprefix={}]
            \ifnum \value{bibgrouped}>0
                \insertbiblioauthorgrouped    % Вывод всех работ автора, сгруппированных по источникам
            \else
                \insertbiblioauthor      % Вывод всех работ автора
            \fi
        \end{refcontext}
    }{
        \ifnum \totvalue{citeexternal}>0
            \begin{refcontext}[labelprefix=A]
                \ifnum \value{bibgrouped}>0
                    \insertbiblioauthorgrouped    % Вывод всех работ автора, сгруппированных по источникам
                \else
                    \insertbiblioauthor      % Вывод всех работ автора
                \fi
            \end{refcontext}
        \else
            \ifnum \value{bibgrouped}>0
                \insertbiblioauthorgrouped    % Вывод всех работ автора, сгруппированных по источникам
            \else
                \insertbiblioauthor      % Вывод всех работ автора
            \fi
        \fi
        %  \insertbiblioauthorimportant  % Вывод наиболее значимых работ автора (определяется в файле characteristic во второй section)
        \begin{refcontext}[labelprefix={}]
            \insertbiblioexternal            % Вывод списка литературы, на которую ссылались в тексте автореферата
        \end{refcontext}
        % Невидимый библиографический список для подсчёта количества внешних публикаций
        % Используется, чтобы убрать приставку "А" у работ автора, если в автореферате нет
        % цитирований внешних источников.
        \printbibliography[heading=nobibheading, section=0, env=countexternal, keyword=biblioexternal, resetnumbers=true]%
    }
}
\ifdefmacro{\microtypesetup}{\microtypesetup{protrusion=true}}{}
\urlstyle{tt}                               % возвращаем установки шрифта ссылок URL
